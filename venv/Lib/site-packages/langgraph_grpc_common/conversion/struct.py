from collections.abc import Mapping
from typing import Any

import orjson
from google.protobuf import struct_pb2


def struct_from_dict(d: Mapping[str, Any]) -> struct_pb2.Struct:
    s = struct_pb2.Struct()
    s.update(d)
    return s


def raw_map_from_dict(d: Mapping[str, Any]) -> Mapping[str, bytes]:
    return {k: orjson.dumps(v) for k, v in d.items()}


def dict_from_raw_map(m: Mapping[str, bytes]) -> dict[str, Any]:
    return {k: orjson.loads(v) for k, v in m.items()}
